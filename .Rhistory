axis.title.x = element_text(size=15),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
gg2 <- ggplot() +  geom_histogram(data = more_than_1_conseq_at_shorter_offset %>% filter(intron_bin == "501-1000"), aes(x = MoreTx, fill=''), bins =100, color = 'black', fill= "#404080") +
geom_label( aes(x =720, y = 4, label="Variants originally assigned to '501-1000+' bin"), size = 6, color="black") +
xlim(0, 1000) +
scale_y_reverse() +
theme_bw() +
xlab('Distance to splice site') +
ylab('Counts') +
xlim(0,1000) +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=15),
axis.text.x = element_text(size=15),
axis.title.y = element_text(size=15),
axis.title.x = element_text(size=15),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggpubr::ggarrange(gg1, gg2,
ncol = 1, nrow = 2)
# Limit the range to 1000bp for clear depiction
# 41 1000+ variants are still > 1000+; 5 501-1000 are still > 500
gg1 <- ggplot() +
geom_histogram(data = more_than_1_conseq_at_shorter_offset %>% filter(intron_bin == "1000+"), aes(x = MoreTx), bins = 100, color = 'black', fill="antiquewhite2") +
geom_label( aes(x =700, y = 20, label="Variants originally assigned to '1000+' bin"), size = 6, color="black") +
xlim(0, 1000) +
theme_bw() +
xlab('Distance to splice site') +
ylab('Counts') +
xlim(0,1000) +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=15),
axis.text.x = element_text(size=15),
axis.title.y = element_text(size=15),
axis.title.x = element_text(size=15),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
gg2 <- ggplot() +  geom_histogram(data = more_than_1_conseq_at_shorter_offset %>% filter(intron_bin == "501-1000"), aes(x = MoreTx, fill=''), bins =100, color = 'black', fill= "#404080") +
geom_label( aes(x =700, y = 4, label="Variants originally assigned to '501-1000+' bin"), size = 6, color="black") +
xlim(0, 1000) +
scale_y_reverse() +
theme_bw() +
xlab('Distance to splice site') +
ylab('Counts') +
xlim(0,1000) +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=15),
axis.text.x = element_text(size=15),
axis.title.y = element_text(size=15),
axis.title.x = element_text(size=15),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggpubr::ggarrange(gg1, gg2,
ncol = 1, nrow = 2)
ggplot() +
geom_boxplot(data = outt, aes(y=analysis, x=weighted_F1), outlier.shape = NA, alpha = 0.7, fill = 'antiquewhite2') +
geom_point(data= outt %>% filter(weighted_F1 < 0.65),
position = position_dodge(width=1),
size = 1,
aes(y=analysis, x=weighted_F1)) +
geom_point(data= outt %>% filter(weighted_F1 >= 0.65),
size = 4,
position = position_jitter(width = 0, height = 0.2),
aes(y=analysis, x=weighted_F1, colour=tool)) +
geom_vline(xintercept = 0.65, linetype='dashed') +
scale_color_manual(values = brewer.pal(12, "Set3")) +
theme_bw() +
xlim(0, 1) +
xlab('Weighted F1') +
ylab('') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=13),
axis.text.x = element_text(size=13),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.text = element_text(size=12)) +
guides(colour = guide_legend(override.aes = list(size=6)))
out_exonic <- read_tsv("out/clinvar_plus_500_exonic/1s_l/tools_benchmark/snps/results_tsv/statistics_snps_all.tsv")
out_exonic$analysis <- "Exonic"
out_1_conseq <- read_tsv("out/clinvar_plus_500_intronic_1_conseq/1s_l/tools_benchmark/snps/results_tsv/statistics_snps_all.tsv")
out_1_conseq$analysis <- "No other transcript"
out_more_1_same_offset <- read_tsv("out/clinvar_plus_500_intronic_moreThan1Tx_same_offset/1s_l/tools_benchmark/snps/results_tsv/statistics_snps_all.tsv")
out_more_1_same_offset$analysis <- "> 1 transcript (same offset)"
out_more_1_smaller_offset <- read_tsv("out/clinvar_plus_500_intronic_moreThan1Tx_smaller_offset/1s_l/tools_benchmark/snps/results_tsv/statistics_snps_all.tsv")
out_more_1_smaller_offset$analysis <- "> 1 transcript (smaller offset)"
outt <- bind_rows(list(out_exonic, out_1_conseq, out_more_1_same_offset, out_more_1_smaller_offset)) %>% select(tool, weighted_F1, average_precision, fraction_nan, analysis)
outt$analysis <- factor(outt$analysis, levels = rev(c("No other transcript",
"> 1 transcript (same offset)",
"> 1 transcript (smaller offset)",
"Exonic")))
# Remove splicing tools with range limits
outt <- outt %>% filter(!tool %in% c("HAL", "SPIDEX", "dbscSNV", "S-CAP", "kipoiSplice4", "MLCsplice", "MMSplice", "MaxEntScan"))
ggplot() +
geom_boxplot(data = outt, aes(y=analysis, x=weighted_F1), outlier.shape = NA, alpha = 0.7, fill = 'antiquewhite2') +
geom_point(data= outt %>% filter(weighted_F1 < 0.65),
position = position_dodge(width=1),
size = 1,
aes(y=analysis, x=weighted_F1)) +
geom_point(data= outt %>% filter(weighted_F1 >= 0.65),
size = 4,
position = position_jitter(width = 0, height = 0.2),
aes(y=analysis, x=weighted_F1, colour=tool)) +
geom_vline(xintercept = 0.65, linetype='dashed') +
scale_color_manual(values = brewer.pal(12, "Set3")) +
theme_bw() +
xlim(0, 1) +
xlab('Weighted F1') +
ylab('') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=13),
axis.text.x = element_text(size=13),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
axis.line = element_line(colour = "black"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
legend.text = element_text(size=12)) +
guides(colour = guide_legend(override.aes = list(size=6)))
###################################################
### Compare last two bins with previous results ###
###################################################
out_500_old <- read_tsv('out/out_clinvar_all/1s_l/intron_analysis/results_tsv/statistics_all_501-1000.tsv') %>% select(tool, weighted_F1) %>% dplyr::rename(old = weighted_F1)
out_1000_old <- read_tsv('out/out_clinvar_all/1s_l/intron_analysis/results_tsv/statistics_all_1000+.tsv') %>% select(tool, weighted_F1) %>% dplyr::rename(old = weighted_F1)
out_500_new <- read_tsv('out/out_clinvar_excluding_exonic_and_closer_to_ss_all_tools/1s_l/intron_analysis/results_tsv/statistics_all_501-1000.tsv') %>% select(tool, weighted_F1) %>% dplyr::rename(new = weighted_F1)
out_1000_new <- read_tsv('out/out_clinvar_excluding_exonic_and_closer_to_ss_all_tools/1s_l/intron_analysis/results_tsv/statistics_all_1000+.tsv') %>% select(tool, weighted_F1) %>% dplyr::rename(new = weighted_F1)
out_500 <- left_join(out_500_old, out_500_new)
out_500$bin <- "500-1000"
out_1000 <- left_join(out_1000_old, out_1000_new)
out_1000$bin <- "1000+"
splicing_tools_to_remove <- c("HAL", "SPIDEX", "dbscSNV", "S-CAP", "kipoiSplice4", "MLCsplice", "MMSplice", "MaxEntScan")
to_plot <- bind_rows(out_500, out_1000) %>% filter(!tool %in% splicing_tools_to_remove)
to_plot$difference <- to_plot$new - to_plot$old
to_plot <- to_plot %>% arrange(-difference)
to_plot$bin = factor(to_plot$bin, levels=c("500-1000","1000+"))
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
to_plot
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(label=new), cex=0.6, col='red') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), cex=0.6, col='red') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), cex=1, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), cex=5, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), cex=5, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
text=element_text(hjust=0.4),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), cex=5, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
text=element_text(hjust=1),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), hjust=1, cex=5, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), hjust=5, cex=5, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), hjust=-1, cex=5, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), hjust=-0.5, cex=5, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), hjust=-0.5, cex=5, col='black', subset = difference > 0) +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), hjust=-0.5, cex=5, col='black', subset = difference > 0) +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(aes(x=difference, y=reorder(tool, difference), label=new), hjust=-0.5, cex=5, col='black', subset=difference > 0) +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(data=subset(to_plot, difference > 0), aes(x=difference, y=reorder(tool, difference), label=new), hjust=-0.5, cex=5, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(data=subset(to_plot, difference > 0), aes(x=difference, y=reorder(tool, difference), label=new), hjust=-0.5, cex=4, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=11),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
ggplot(to_plot) +
geom_point(aes(x = difference, y = reorder(tool, difference), fill = "antiquewhite2"), size = 3, pch=21, color = 'black') +
geom_vline(xintercept = 0, linetype="dotted", color = "black", size=0.75) +
scale_fill_manual(values=c("antiquewhite2")) +
facet_wrap(~bin) +
geom_text(data=subset(to_plot, difference > 0), aes(x=difference, y=reorder(tool, difference), label=new), hjust=-0.5, cex=4, col='black') +
xlim(c(-0.6,0.4)) +
ylab('') +
xlab('Performance difference (measured by Weighted F1)') +
theme(legend.title=element_blank(),
axis.text.y = element_text(size=12),
axis.text.x = element_text(size=12),
axis.title.y = element_text(size=13),
axis.title.x = element_text(size=13),
strip.text.x = element_text(size = 12),
axis.line = element_line(colour = "black"),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank())
